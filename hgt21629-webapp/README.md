# HG/T21629-2021 管架材料统计系统

基于化工行业标准 HG/T 21629-2021《管架标准图》开发的 Web 应用，支持导入支吊架清单，自动统计详细的材料清单。

## 功能特性

- 📁 **多格式文件导入**：支持 Excel (.xlsx, .xls)、CSV、TXT 文件
- 🔍 **智能编号识别**：自动解析 HG/T21629 标准管架编号
- 📊 **自动材料统计**：根据管架类型自动生成详细材料清单
- ⚠️ **错误提示**：识别无效的管架编号并给出提示
- 📥 **结果导出**：支持导出为 Excel 或 CSV 格式

## 快速开始

### 1. 直接使用

直接在浏览器中打开 `index.html` 文件即可使用（需要联网加载 SheetJS 库）。

### 2. 输入方式

系统支持三种数据输入方式：

#### 方式一：文件导入
- 支持 Excel (.xlsx/.xls)、CSV、TXT 文件
- 拖拽文件到上传区域或点击选择文件

#### 方式二：表格输入
- 在界面表格中直接输入管架数据
- 支持添加/删除行、Tab 键跳转、Enter 键新增行
- 实时验证管架编号格式

#### 方式三：文本导入
- 在文本框中批量粘贴数据
- 支持多种分隔符（逗号、空格、Tab）
- 支持每行一条记录，快速导入

### 3. 支持的文件格式

#### Excel 格式
- 文件扩展名：`.xlsx` 或 `.xls`
- 第一行应为表头（包含"编号"、"数量"等关键词）
- 数据从第二行开始

#### CSV 格式
- 文件扩展名：`.csv`
- 逗号分隔的文本文件
- 支持带引号的字段

#### TXT 格式
- 文件扩展名：`.txt`
- 自动检测分隔符（Tab、逗号、竖线）

### 3. 文件内容示例

```csv
编号,名称,数量,管径,备注
A1-1-A-200,U形螺栓 DN200,10,200,
D4-1-A-100-200,悬臂架 DN100,8,100,梁上生根
E1-A-200-S,导向架 DN200,6,200,滑动型
G1-A,地面锚板,12,,
```

### 4. 手动输入示例

#### 表格输入
在"表格输入"标签页中，直接填写表格：

| 管架编号 | 名称 | 数量 | 管径 | 备注 |
|---------|------|------|------|------|
| A1-1-A-200 | U形螺栓 | 10 | 200 | - |
| D4-1-A-100-200 | 悬臂架 | 8 | 100 | 梁上生根 |
| G1-A | 地面锚板 | 20 | - | - |

#### 文本导入
在"文本导入"标签页中，粘贴以下内容：

```
A1-1-A-200,10
D4-1-A-100-200 8
G1-A
E1-A-200-S,12,200,滑动型
```

支持格式：
- `编号,数量` - 逗号分隔
- `编号 数量` - 空格分隔
- `编号` - 数量默认为 1
- `编号,数量,管径,备注` - 逗号分隔完整信息

## 管架编号规则

### 基本格式
```
[类别][序号]-[序列号]-[载荷等级]-[管径]-[其他参数]
```

### 常用编号示例

| 编号 | 说明 |
|------|------|
| `A1-1-A-200` | A1型U形螺栓，载荷A，DN200 |
| `A2-2-B-300` | A2型管夹，序列2，载荷B，DN300 |
| `D4-1-A-100-200` | D4悬臂架，序列1，载荷A，DN100，长度200 |
| `D5-2-C-200-1000-300` | D5三角架，序列2，载荷C，DN200，长1000高300 |
| `E1-A-200-S` | E1导向架，载荷A，DN200，S=滑动型 |
| `F2-100-50-C1-500` | F2支腿，大小头DN100/50，C1级，长500 |
| `G1-A` | G1地面锚板，载荷A |
| `J1-65-200-300-C1` | J1管托，保温65mm，DN200，长300，C1级 |

### 载荷等级

| 等级 | 含义 |
|------|------|
| A | 轻载 |
| B | 中轻载 |
| C | 中载 |
| D | 重载 |
| E | 超重载 |

## 材料清单输出

### 表格字段

| 字段 | 说明 |
|------|------|
| 序号 | 材料序号 |
| 材料名称 | 材料名称（如：槽钢、钢板、螺栓等） |
| 规格 | 材料规格（如：[100×48×5.3、M16等） |
| 数量 | 汇总数量 |
| 单位 | 计量单位（件、套、个等） |
| 材料采用的技术标准 | 对应的国家标准或行业标准 |
| 材料 | 材质（Q235B、20#、15CrMo等） |

### 材料标准引用

| 材料 | 标准号 | 说明 |
|------|--------|------|
| Q235B | GB/T 700 | 碳素结构钢 |
| Q355B | GB/T 1591 | 低合金高强度结构钢 |
| 20# | GB/T 699 | 优质碳素结构钢 |
| 15CrMo | GB/T 3077 | 合金结构钢（高温用） |
| 型钢 | GB/T 706 | 热轧型钢 |
| 螺栓 | GB/T 5782 | 六角头螺栓 |
| U形螺栓 | GB/T 798 | 活节螺栓（参考） |

## 支持的管架类别

### A类 - 管架零部件
- A1 ~ A31：U形螺栓、管夹、吊板、螺母等

### D类 - 钢结构生根辅助钢结构
- D1 ~ D20：悬臂架、三角架、门形架、T形架等

### E类 - 导向架
- E1 ~ E12：各种导向架、限位架

### F类 - 耳轴/支腿/耳座
- F1 ~ F20：各类耳轴、支腿、耳座

### G类 - 地面/混凝土生根支架
- G1 ~ G17：地面锚板、混凝土生根支架

### H类 - 可调支架
- H1 ~ H3：可调支架

### J类 - 管托
- J1 ~ J16：焊接式/管夹式管托

### K类 - 限位架
- K1 ~ K4：限位架、固定架

### L类 - 保冷管架
- L1 ~ L25：保冷管托、保冷吊架

### Q类 - 大管支撑小管/小支管加强架
- Q1 ~ Q16：加强架

## 使用步骤

1. **准备数据**：按示例格式整理支吊架清单
2. **导入文件**：拖拽或点击选择文件上传
3. **开始统计**：点击"开始统计"按钮
4. **查看结果**：在"材料清单"标签页查看统计结果
5. **导出数据**：点击"导出 Excel"或"导出 CSV"保存结果

## 注意事项

1. 管架编号必须符合 HG/T 21629-2021 标准格式
2. 材料统计仅供参考，实际工程应以设计图纸为准
3. 标准图集中部分细节参数可能需要根据实际工程调整
4. 高温、低温、腐蚀等特殊工况的材料可能需要特殊考虑

## 浏览器兼容性

- Chrome 80+
- Firefox 75+
- Edge 80+
- Safari 13+

## 技术栈

- 纯前端实现，无需后端服务
- SheetJS (xlsx.js) 处理 Excel 文件
- Font Awesome 图标
- 原生 JavaScript (ES6+)

## 许可证

本项目仅供学习和技术交流使用。

标准依据：HG/T 21629-2021《管架标准图》
